# Usage guide

## Prerequisites

- Python 3
- [Miri](https://github.com/rust-lang/miri)
- [Crux](https://github.gatech.edu/ybae38/Crux)
- [sccache](https://github.com/mozilla/sccache)
  - Technically it can be optional, but I was lazy.
  - `sccache` should be on `PATH`

## Metadata Format

### target

- **crate**: (string) the name of the crate
- **version**: (string) the version to test the poc
- **peer**: (object array) peer dependencies, follows the same pattern with target. See `./poc/0004-rocket.rs` for an example.

### test

- **analyzers**: (string array) an array of analyzers that are expected to report bugs for this crate
- **cargo_flags**: (string array) Cargo flags to append, for example `["--release"]` (optional)
- **cargo_toolchain**: (string) Specify the compiler toolchain if necessary

### report

- **title**: (string) issue title
- **description**: (string) issue description
- **code_snippets**: (array) code snippets that will be only included in the issue report (array)
- **issue_url**: (string) original repository issue URL (autogenerated, optional)
- **issue_date**: (date) disclosure date (autogenerated **OR** manual)
- **patched**: (string array) RustSec `versions.patched`
- **unaffected**: (string array) RustSec `versions.unaffected` (optional)
- **rustsec_url**: (string) RustSec PR URL (autogenerated)
- **rustsec_id**: (string) RustSec ID (autogenerated)

## Workflow

### 1. PoC generation

```shell
./poc.py add <crate> <version>
```

### 2. PoC testing

Fill in the metadata section and complete the PoC code.

```shell
./poc.py run <PoC ID>
```

### 3. Issue reporting (WIP)

```shell
# reports to both the original repository and RustSec
./poc.py report <PoC ID>
# reports only to the original repository
./poc.py report --original <PoC ID>
# and then later reports to RustSec
./poc.py report --rustsec <PoC ID>
```

Reporting Guideline:

- If the crate seems unmaintained, reports both to the original repository and RustSec
- Otherwise, report to the original repository first and wait for the developer to confirm
